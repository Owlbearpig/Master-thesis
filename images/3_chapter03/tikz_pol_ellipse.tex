\documentclass{standalone}

\usepackage{tikz}
\usepackage{fp}
\usepackage{ifthen}      %for \ifthenelse{}{}{} conditional statements
\usetikzlibrary{calc, decorations.markings, arrows}

\begin{document}

%line thickness styles:  ultra thin, very thin, (thin), semithick, thick, very thick, ultra thick
%line dash styles: loosely dashed, densely dashed, loosely dotted, densely dotted
\tikzset{bkgd_line/.style={very thin,color=gray}}
\tikzset{dashed_bkgd_line/.style={thin, dashed,color=gray}}

\tikzset{dimension_line/.style={thin,color=gray}}
\tikzset{axis_line/.style={thin}}
\tikzset{object_line/.style={thick}}
\tikzset{textlabel/.style={color=black}}



\newcommand{\polellipse}[3]{%
    \coordinate(origin) at (0,0);



\FPset{\LABELOFFSET}{.1}

\FPset{\Eoy}{#2}
\FPset{\Eox}{#1}
\FPset{\phase}{#3}

\FPiflt{\phase}{0}
    \FPadd{\phase}{\phase}{360}
\else \fi

\FPmul{\phase}{\phase}{\FPpi}
\FPdiv{\phase}{\phase}{180}

%Begin calculations, and reality check
%=====================================
\ifthenelse{\equal{\Eox}{0}}{%
    %error case: \Eox = \Eoy = 0
    \FPifzero{\Eoy}
        \errmessage{ELLIPSE PLOT ERROR: Both Eox and Eoy cannot be zero!}
    \else \fi
    
    %special case: \Eox = 0
    \FPdiv{\alp}{\FPpi}{2}          %\alp = \pi/2
}
{%
    %normal case, \Eox \neq 0
    \FPdiv{\scratch}{\Eoy}{\Eox}    %\scratch = \Eoy/\Eox
    \FParctan{\alp}{\scratch}       %\alp = \arctan{\scratch}
}

%normalize magnitudes, used for plotting
%=======================================

\FPpow{\scratchy}{\Eoy}{2}            %\scratchy = \Eoy^2
\FPpow{\scratchx}{\Eox}{2}            %\scratchx = \Eox^2
\FPadd{\scratch}{\scratchy}{\scratchx}%\scratch = \scratchy + \scratchx
\FProot{\norm}{\scratch}{2}           %\norm = \sqrt{\scratch}

\FPdiv{\Eoynorm}{\Eoy}{\norm}         %\Eoynorm = \Eoy / \norm
\FPdiv{\Eoxnorm}{\Eox}{\norm}         %\Eoynorm = \Eox / \norm

%determine major and minor axes
%==============================

\FPmul{\scratch}{\alp}{2}             %\scratch = \alp* 2
\FPsin{\sintwoalp}{\scratch}          %\alp = \sin\scratch

%\sin2\chi = \sin2\alp \sin\phase
\FPsin{\scratch}{\phase}              %\scratch = \sin\phase
\FPmul{\sintwochi}{\scratch}{\sintwoalp} %\sintwochi = \scratch * \sintwoalp

%solve for \tan\chi
\FParcsin{\scratch}{\sintwochi}      %\scratch = \arcsin{\sintwochi}
\FPdiv{\scratch}{\scratch}{2}        %\scratch = \scratch / 2
\FPtan{\tanchi}{\scratch}            %\tanchi = \tan{\scratch}

%if \tanchi is less than zero, the proceeding power operation will fail.
\FPabs{\tanchi}{\tanchi}

%\b = -\frac{\tanchi}{\sqrt{ 1 + \tanchi^2}}
\FPpow{\scratch}{\tanchi}{2}         %\scratch = \tanchi^2

\FPadd{\scratch}{\scratch}{1}        %\scratch = \scratch + 1
\FProot{\scratch}{\scratch}{2}       %\scratch = \sqrt{\scratch}
\FPdiv{\b}{\tanchi}{\scratch}        %\b = \tanchi / \scratch

%\a = \sqrt{1 - \b^2}
\FPpow{\scratch}{\b}{2}            %\scratch = \b^2
\FPsub{\scratch}{1}{\scratch}      %\scratch = 1 - \scratch
\FProot{\a}{\scratch}{2}           %\a = \sqrt{\scratch}


%determine orientation angle
%===========================

%\tantwoalp = \tan{2\alp}
\FPmul{\twoalp}{\alp}{2}      %\scratch = \alp * 2

%check for infinite tan!
\FPmul{\scratch}{\twoalp}{180}
\FPdiv{\scratch}{\scratch}{\FPpi}
\FPround{\scratch}{\scratch}{3}
\ifthenelse{\equal{\scratch}{90.000}}{%
    %special case: if \twoalp is 90 degrees, \tantwoalp will be infinite

    \FPset{\orang}{\alp}                %force \orang to \alp
}
{
    %regular case
    \FPtan{\tantwoalp}{\twoalp}      %\tantwoalp = \tan\scratch

    %\tantwopsi = \tantwoalp \cos\phase
    \FPcos{\scratch}{\phase}        %\scratch = \cos\phase
    \FPmul{\tantwopsi}{\tantwoalp}{\scratch} %\tantwopsi = \tantwoalp * \scratch
    \FParctan{\scratch}{\tantwopsi}        %\scratch = \arctan{\tantwopsi}
    \FPdiv{\orang}{\scratch}{2}        %\orang = \scratch / 2

    %assign proper quadrant:  if the orientation angle is less than zero, increase by 90 degrees
    \FPiflt{\orang}{0}
        \FPdiv{\scratch}{\FPpi}{2}
        \FPadd{\orang}{\orang}{\scratch}
    \else \fi
}

%convert \phase to degrees
\FPmul{\phase}{\phase}{180}
\FPdiv{\phase}{\phase}{\FPpi}
\FPround{\phase}{\phase}{1}

%convert \orang to degrees
\FPmul{\orang}{\orang}{180}
\FPdiv{\orang}{\orang}{\FPpi}

%final check on proper quadrant:  if \phase is between 90 and 270, increase orientation by 90 degrees
\FPset{\scratch}{0}
\FPifgt{\phase}{90.0}
    %if the first test passes, then prime the increment amount
    \FPset{\scratch}{90}
\else \fi
\FPiflt{\phase}{270}
    %if the second test passes, then increment by amount.  This will be zero if the first test didn't pass, and so we have a makeshift AND operation here!
    \FPadd{\orang}{\orang}{\scratch}    %add \pi/2 to orientation angle
\else \fi

%if Eox was zero to start with, just set orientation to 90 degrees
\FPifzero{\Eox}
    %special case: \Eox = 0
    \FPset{\orang}{90}          %\orang = 90 degrees
\else \fi

%determine perpendicular axis direction for rendering minor axis

    %define points for labels
    \begin{scope}[rotate around={\orang:(origin)}]
        \coordinate (a) at ($ (\a in, 0) + (\LABELOFFSET in,0) $);
        \coordinate (b) at ($ (0, \b in) + (0,\LABELOFFSET in)$);

        %determine arrow position and direction
        \coordinate (arrow1front) at ($ (0, \b in) $);
        \coordinate (arrow2front) at ($ (0, -\b in) $);
        \FPifgt{\phase}{180}
            \coordinate (arrow1back) at ($ (0, \b in) - .001*(\a in,0) $);
            \coordinate (arrow2back) at ($ (0, -\b in) + .001*(\a in,0) $);
        \else 
            \coordinate (arrow1back) at ($ (0, \b in) + .001*(\a in,0) $);
            \coordinate (arrow2back) at ($ (0, -\b in) - .001*(\a in,0) $);
        \fi
    \end{scope}

    %points for labels Eox, Eoy, \delta
    \coordinate (e) at ($ .5*(\Eoxnorm in,0) + (0,-\Eoynorm in) $);
    \coordinate (f) at ($ .5*(0,-\Eoynorm in) + (\Eoxnorm in,0) $);
    \coordinate (g) at ($ (-.2in,0) + (0,\Eoynorm in) $);

    %draw the x-y plane
    \draw[axis_line, ->] (-\Eoxnorm in,0) -- (1.2 in,0) node[textlabel,anchor=west]{$x$};
    \draw[axis_line, ->] (0,-\Eoynorm in) -- (0,0.9 in) node[textlabel,anchor=south]{$y$};
    
    %draw the major and minor axis lines
    \draw[dimension_line,rotate=\orang] (-\a in,0) -- (\a in,0);
    \draw[dimension_line,rotate=\orang] (0, -\b in) -- (0, \b in);
    
    \draw[dimension_line,rotate=\orang] (-\a in,0) -- (0, \b in);
    
    \FPmul{\ascale}{\a}{0.6}
    \draw[dimension_line,rotate=\orang] (-\ascale in,0) arc (0:\orang:.329in);
    \FPdiv{\scratch}{\orang}{1.5}
    \FPmul{\ascale}{\a}{0.55}
    \draw[rotate=\scratch] (-\ascale in,0.1) node[textlabel]{$\chi$};
    
    %draw the x-y amplitude bounding box
    \draw[dimension_line] (-\Eoxnorm in,-\Eoynorm in) rectangle (\Eoxnorm in,\Eoynorm in);

    %draw the ellipse and arrows showing the sense of rotation
    \draw[object_line,rotate=\orang,->] (0,0) ellipse (\a in and \b in);
    \draw[object_line,->] (arrow1back) -- (arrow1front);
    \draw[object_line,->] (arrow2back) -- (arrow2front);

    %label major-minor axes
    \FPifgt{\b}{.1}    %threshold for displaying major-minor axis labels
        \draw (a) node[textlabel]{$a$}; %=\a);  %uncomment and merge if you want to display the major axis size.  Maybe do a \FPround{\a}{\a}{1} beforehand!
        \draw (b) node[textlabel]{$b$}; %=\b);  %uncomment and merge if you want to display the minor axis size.  Maybe do a \FPround{\b}{\b}{1} beforehand!
    \else \fi
    
    \draw[object_line,<->] (arrow2back) -- (arrow2front);
    %\node at (-\Eoxnorm in,-\Eoynorm in) (nA) {A};
    %\node at (\Eoxnorm in,-\Eoynorm in) (nB) {B};
    %\Dimline[($(nA)+(0,1)$)][($(nB)+(0,1)$)]['test'];
    %\FPmul{\}{}{}

    
    
    %label the x-y components and delta
    %\draw (e) node[textlabel,anchor=north]{$E_{0x} = \Eox$};
    %\draw (f) node[textlabel,anchor=north west]{$E_{0y} = \Eoy$};
    %\draw (g) node[textlabel,anchor=south east]{$\delta = \phase^\circ$};

    %label orinetation angle
    \FPifgt{\orang}{1}    %threshold for displaying orientation angle
        \draw[dimension_line] (.3in, 0) arc (0:\orang:.3in);
        \FPdiv{\scratch}{\orang}{2}    %scratch = ema/2
        \draw[rotate=\scratch] (.5in,0) node[textlabel]{$\psi$};
    \else \fi
}



\pgfarrowsdeclarecombine{dimarrow}{dimarrow}{latex}{latex}{}{}
\def\Dimline[#1][#2][#3][#4]{
        \path #1 -- node (#4) {\emph{$#4$}} #3;
        \draw[-|,
        decoration={markings, 
                mark=at position 1 with {\arrow[scale=1.5]{dimarrow}};,
            },
        postaction=decorate] (#4) -- #1;
        \draw[|-,
        decoration={markings, 
                mark=at position 0 with {\arrowreversed[scale=1.5]{dimarrow}};,
            },
        postaction=decorate] #3 -- (#4);
}

\begin{tikzpicture}

    \polellipse{1}{0.65}{55}
    \FPmul{\lowestpnt}{\Eoynorm}{1.2}
    \Dimline[(-\Eoxnorm in,-\lowestpnt in)][(0,-\lowestpnt in)][(\Eoxnorm in,-\lowestpnt in)][2E_{0x}];
    \FPmul{\lowestpnt}{\Eoxnorm}{1.2}
    \Dimline[(-\lowestpnt in,-\Eoynorm in)][(-\lowestpnt,0)][(-\lowestpnt in,\Eoynorm in)][2E_{0y}];
    %\draw[use as bounding box] (-1.2in,-1.5in) rectangle (1.5in,1.5in);
    
\end{tikzpicture}

\end{document}